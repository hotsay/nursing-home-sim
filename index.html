<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš”ì–‘ì› ê²½ì˜ ì»¨ì„¤íŒ… í†µí•© ì‹œë®¬ë ˆì´í„°</title>
    <style>
        :root {
            --primary: #2c3e50; --accent: #3498db; --success: #27ae60; --danger: #e74c3c; --bg: #f1f4f9;
        }
        body { font-family: 'Pretendard', sans-serif; background: var(--bg); margin: 0; padding: 0; color: #333; }
        
        /* íƒ­ ìŠ¤íƒ€ì¼ */
        .tab-nav { background: var(--primary); display: flex; justify-content: center; padding: 10px 0; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
        .tab-btn { background: none; border: none; color: rgba(255,255,255,0.6); padding: 10px 25px; font-size: 1.1rem; font-weight: bold; cursor: pointer; transition: 0.3s; border-radius: 8px; margin: 0 5px; }
        .tab-btn.active { color: white; background: rgba(255,255,255,0.15); box-shadow: inset 0 -3px 0 var(--accent); }
        .tab-btn:hover { color: white; }

        .container { max-width: 1400px; margin: 20px auto; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* ê³µí†µ ìŠ¤íƒ€ì¼ */
        .dashboard { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 25px; }
        .card { background: var(--primary); color: white; padding: 18px; border-radius: 12px; text-align: center; }
        .card h3 { margin: 0; font-size: 0.9rem; opacity: 0.8; margin-bottom: 8px; }
        .card .value { font-size: 1.6rem; font-weight: bold; }
        .card.pass { background: var(--success); }
        .card.fail { background: var(--danger); }
        .highlight-card { background: #fff; color: var(--primary); border: 2px solid var(--accent); }
        .highlight-card .value { color: var(--accent); }

        .main-grid { display: grid; grid-template-columns: 1fr 1.2fr; gap: 25px; }
        section { background: #fff; border: 1px solid #e0e6ed; padding: 20px; border-radius: 12px; margin-bottom: 20px; }
        h2 { font-size: 1.2rem; color: var(--primary); border-left: 5px solid var(--accent); padding-left: 10px; margin-bottom: 15px; }

        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #eee; padding: 10px 5px; text-align: center; font-size: 0.88rem; }
        th { background: #f8f9fa; color: #666; }
        input { width: 85%; padding: 6px; border: 1px solid #ccc; border-radius: 4px; text-align: right; font-weight: bold; }
        
        .info-box { background: #f1f9ff; border: 1px solid #d1e9ff; padding: 15px; border-radius: 8px; font-size: 0.85rem; line-height: 1.6; margin-top: 10px; }
        .sub-total { background: #fdf6e3; font-weight: bold; }
        .status-badge { display: inline-block; padding: 5px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: bold; margin-top: 5px; background: rgba(255,255,255,0.2); }
        .analysis-box { background: #f9f9f9; padding: 15px; border-radius: 8px; border: 1px dashed #ccc; text-align: center; font-weight: bold; }
        input.error { border: 2px solid var(--danger); background: #fff5f5; }
    </style>
</head>
<body>

<nav class="tab-nav">
    <button class="tab-btn active" onclick="openTab('main-sim')">ğŸ“Š ì¢…í•© ì¸ê±´ë¹„ ë¹„ìœ¨ ë¶„ì„</button>
    <button class="tab-btn" onclick="openTab('night-sim')">ğŸŒ™ ì•¼ê°„ ê·¼ë¬´ ìˆ˜ì§€ ë¶„ì„</button>
</nav>

<div class="container">
    
    <div id="main-sim" class="tab-content active">
        <h1 style="text-align:center; color:var(--primary); margin-top:0;">ìš”ì–‘ì› ì¸ê±´ë¹„ ì§€ì¶œ ë¹„ìœ¨ ë¶„ì„</h1>
        
        <div class="dashboard">
            <div class="card"><h3>ì´ ì…ì†Œ ì¸ì›</h3><div id="top-inmates" class="value">0 ëª…</div></div>
            <div class="card"><h3>ì´ ê¸‰ì—¬ ìˆ˜ì… (A)</h3><div id="top-total-income" class="value">0</div></div>
            <div class="card"><h3>ì´ ì¸ê±´ë¹„ ì§€ì¶œ (B)</h3><div id="top-total-labor" class="value">0</div></div>
            <div id="ratio-card" class="card">
                <h3>ì§€ì¶œ ë¹„ìœ¨ (B/A)</h3>
                <div id="top-ratio" class="value">0%</div>
                <div id="status-badge" class="status-badge">ê³„ì‚° ì¤‘...</div>
            </div>
        </div>

        <div class="main-grid">
            <div>
                <section>
                    <h2>1. ìˆ˜ì… ì„¤ì •</h2>
                    <table>
                        <thead><tr><th>ë“±ê¸‰</th><th>ì¸ì›</th><th>ìˆ˜ê°€</th><th>ì›” ìˆ˜ì…</th></tr></thead>
                        <tbody>
                            <tr><td>ì¼ë°˜ 1ë“±ê¸‰</td><td><input type="number" id="in-c1" value="5" oninput="mainCalc()"></td><td>93,070</td><td id="res-c1">0</td></tr>
                            <tr><td>ì¼ë°˜ 2ë“±ê¸‰</td><td><input type="number" id="in-c2" value="13" oninput="mainCalc()"></td><td>86,340</td><td id="res-c2">0</td></tr>
                            <tr><td>ì¼ë°˜ 3~5ë“±ê¸‰</td><td><input type="number" id="in-c3" value="34" oninput="mainCalc()"></td><td>81,540</td><td id="res-c3">0</td></tr>
                            <tr><td>ì¹˜ë§¤ 2ë“±ê¸‰</td><td><input type="number" id="in-cd2" value="0" oninput="mainCalc()"></td><td>96,950</td><td id="res-cd2">0</td></tr>
                            <tr><td>ì¹˜ë§¤ 3~5ë“±ê¸‰</td><td><input type="number" id="in-cd3" value="0" oninput="mainCalc()"></td><td>89,400</td><td id="res-cd3">0</td></tr>
                            <tr class="sub-total"><td>í•©ê³„</td><td id="total-cnt">0</td><td>-</td><td id="total-base-inc">0</td></tr>
                        </tbody>
                    </table>
                </section>
                <section>
                    <h2>2. ê°€ì‚° ìˆ˜ì… (ë¶„ëª¨ í•©ì‚°)</h2>
                    <table style="background:#f1f9ff">
                        <tr><td>ì•¼ê°„ ê°€ì‚° (0.9ì )</td><td id="res-night-inc">0</td></tr>
                        <tr><td>ì¸ë ¥ì¶”ê°€ ê°€ì‚°</td><td id="res-staff-inc">0</td></tr>
                        <tr><td>ê°„í˜¸ì‚¬ ê°€ì‚°</td><td id="res-nurse-bonus-inc">0</td></tr>
                        <tr class="sub-total"><td>ê°€ì‚° ìˆ˜ì… í•©ê³„</td><td id="res-total-add-inc">0</td></tr>
                    </table>
                </section>
            </div>
            <div>
                <section>
                    <h2>3. ì¸ê±´ë¹„ ì§€ì¶œ ì„¤ì • (ë¶„ì)</h2>
                    <table id="staff-table">
                        <thead><tr><th>ì§ì¢…</th><th>ë°°ì¹˜</th><th>ê¸°ë³¸ê¸‰</th><th>ì¸ê±´ë¹„ì´ê³„</th></tr></thead>
                        <tbody id="staff-body"></tbody>
                    </table>
                </section>
                <section>
                    <div class="analysis-box" id="main-analysis-text">
                        ë°ì´í„°ë¥¼ ì…ë ¥í•˜ë©´ ë¶„ì„ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.
                    </div>
                </section>
            </div>
        </div>
    </div>

    <div id="night-sim" class="tab-content">
        <h1 style="text-align:center; color:var(--primary); margin-top:0;">ì•¼ê°„ ê·¼ë¬´ ì¸ë ¥ë°°ì¹˜ ìµœì í™”</h1>
        
        <div class="dashboard">
            <div class="card"><h3>ì•¼ê°„ ê°€ì‚° ìˆ˜ì… (A)</h3><div id="n-disp-income" class="value">0</div></div>
            <div class="card"><h3>ì•¼ê°„ ì¸ê±´ë¹„ ì´ê³„ (B)</h3><div id="n-disp-labor" class="value">0</div></div>
            <div id="n-profit-card" class="card"><h3>ì•¼ê°„ ìš´ì˜ ìˆ˜ì§€ (A-B)</h3><div id="n-disp-profit" class="value">0</div></div>
            <div class="card highlight-card"><h3>ê°€ì‚° ê¸°ì¤€ì  (1ì )</h3><div id="n-disp-base-point" class="value">0</div></div>
        </div>

        <div class="main-grid">
            <div>
                <section>
                    <h2>1. ê¸°ì¤€ì  ì‚°ì¶œ (ì¼ë°˜ì‹¤ êµ¬ì„±)</h2>
                    <table>
                        <thead><tr><th>ë“±ê¸‰</th><th>ì¸ì›</th><th>ì¼ë‹¹ìˆ˜ê°€</th><th>ì›” ìˆ˜ì…ì•¡</th></tr></thead>
                        <tbody>
                            <tr><td>1ë“±ê¸‰</td><td><input type="number" id="n-in-c1" value="5" oninput="nightCalc()"></td><td>93,070</td><td id="n-res-c1">0</td></tr>
                            <tr><td>2ë“±ê¸‰</td><td><input type="number" id="n-in-c2" value="13" oninput="nightCalc()"></td><td>86,340</td><td id="n-res-c2">0</td></tr>
                            <tr><td>3~5ë“±ê¸‰</td><td><input type="number" id="n-in-c3" value="34" oninput="nightCalc()"></td><td>81,540</td><td id="n-res-c3">0</td></tr>
                            <tr class="sub-total"><td>í•©ê³„</td><td id="n-total-cnt">0</td><td>-</td><td id="n-total-inc">0</td></tr>
                        </tbody>
                    </table>
                </section>
            </div>
            <div>
                <section>
                    <h2>2. ì•¼ê°„ ê·¼ë¬´ ë°°ì¹˜ ë° ì¸ê±´ë¹„</h2>
                    <table>
                        <tr><th>ì•¼ê°„ ì‹¤ê·¼ë¬´(h)</th><td><input type="number" id="n-work-h" value="5" oninput="nightCalc()"></td></tr>
                        <tr><th>ì•¼ê°„ ì¸ì›(ëª…)</th><td><input type="number" id="n-staff-c" value="3" oninput="nightCalc()"></td></tr>
                        <tr class="sub-total"><th>ì¼ì¼ í•©ê³„ ì‹œê°„</th><td id="n-total-hours-day">0 h</td></tr>
                    </table>
                    <div class="info-box">
                        ì´ ì•¼ê°„ ì¸ê±´ë¹„(ë³´í—˜/í‡´ì§ê¸ˆ í¬í•¨): <b id="n-total-labor-detail">0</b>ì›
                    </div>
                </section>
                <section>
                    <div id="n-analysis-msg" class="analysis-box">ë¶„ì„ ì¤‘...</div>
                </section>
            </div>
        </div>
    </div>

</div>

<script>
    // íƒ­ ì „í™˜ í•¨ìˆ˜
    function openTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        event.currentTarget.classList.add('active');
        if(tabId === 'main-sim') mainCalc(); else nightCalc();
    }

    // --- 1. ë©”ì¸ ì‹œë®¬ë ˆì´í„° ë¡œì§ ---
    const staffMeta = {
        sw: { name: 'ì‚¬íšŒë³µì§€ì‚¬', pay: 2500000, def: 1 },
        nurse: { name: 'ê°„í˜¸(ì¡°ë¬´)ì‚¬', pay: 2400000, def: 2 },
        care: { name: 'ìš”ì–‘ë³´í˜¸ì‚¬', pay: 2156880, def: 25 },
        etc: { name: 'ê¸°íƒ€/ì‚¬ë¬´', pay: 2100000, def: 1 }
    };

    function initMain() {
        const body = document.getElementById('staff-body');
        Object.entries(staffMeta).forEach(([key, info]) => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td align="left"><b>${info.name}</b></td>
                <td><input type="number" id="m-cnt-${key}" value="${info.def}" oninput="mainCalc()"></td>
                <td><input type="number" id="m-pay-${key}" value="${info.pay}" oninput="mainCalc()"></td>
                <td id="m-total-${key}">0</td>
            `;
            body.appendChild(tr);
        });
        mainCalc();
    }

    function mainCalc() {
        const p = { c1:93070, c2:86340, c3:81540, cd2:96950, cd3:89400 };
        let inmates = 0, baseInc = 0;
        ['c1', 'c2', 'c3', 'cd2', 'cd3'].forEach(k => {
            const cnt = Number(document.getElementById('in-'+k).value);
            const inc = cnt * p[k] * 30;
            document.getElementById('res-'+k).innerText = inc.toLocaleString();
            inmates += cnt; baseInc += inc;
        });
        document.getElementById('total-cnt').innerText = inmates;
        document.getElementById('top-inmates').innerText = inmates + " ëª…";

        // ê°€ì‚° ìˆ˜ì… (ë‹¨ìˆœí™”ëœ ì˜ˆì‹œ ë¡œì§)
        const addInc = Math.floor(baseInc * 0.05); // í‰ê·  5% ê°€ì‚° ê°€ì •
        document.getElementById('res-total-add-inc').innerText = addInc.toLocaleString();
        const totalIncome = baseInc + addInc;
        document.getElementById('top-total-income').innerText = totalIncome.toLocaleString();

        let totalLabor = 0;
        const overhead = 1 + 0.09 + (1/12);
        Object.keys(staffMeta).forEach(key => {
            const cnt = Number(document.getElementById('m-cnt-'+key).value);
            const pay = Number(document.getElementById('m-pay-'+key).value);
            const sum = Math.floor(pay * cnt * overhead);
            document.getElementById('m-total-'+key).innerText = sum.toLocaleString();
            totalLabor += sum;
        });
        document.getElementById('top-total-labor').innerText = totalLabor.toLocaleString();

        const ratio = totalIncome > 0 ? (totalLabor / totalIncome * 100).toFixed(1) : 0;
        document.getElementById('top-ratio').innerText = ratio + "%";
        
        const card = document.getElementById('ratio-card');
        const badge = document.getElementById('status-badge');
        if(ratio >= 62.6) {
            card.className = "card pass"; badge.innerText = "ì¤€ìˆ˜ (PASS)";
        } else {
            card.className = "card fail"; badge.innerText = "ë¯¸ë‹¬ (FAIL)";
        }
    }

    // --- 2. ì•¼ê°„ ì‹œë®¬ë ˆì´í„° ë¡œì§ ---
    function nightCalc() {
        const c1 = Number(document.getElementById('n-in-c1').value);
        const c2 = Number(document.getElementById('n-in-c2').value);
        const c3 = Number(document.getElementById('n-in-c3').value);
        const totalCnt = c1 + c2 + c3;
        const totalMonthInc = (c1*93070 + c2*86340 + c3*81540) * 30;
        const basePoint = totalCnt > 0 ? Math.floor((totalMonthInc / totalCnt) * 0.8) : 0;

        document.getElementById('n-total-cnt').innerText = totalCnt;
        document.getElementById('n-total-inc').innerText = totalMonthInc.toLocaleString();
        document.getElementById('n-disp-base-point').innerText = basePoint.toLocaleString();

        const workH = Number(document.getElementById('n-work-h').value);
        const staffC = Number(document.getElementById('n-staff-c').value);
        const dayHours = workH * staffC;
        const monthHours = dayHours * 30;
        document.getElementById('n-total-hours-day').innerText = dayHours + " h";

        const totalLabor = Math.floor(monthHours * 5160 * (1 + 0.09 + 1/12));
        document.getElementById('n-total-labor-detail').innerText = totalLabor.toLocaleString();
        document.getElementById('n-disp-labor').innerText = totalLabor.toLocaleString();

        const addStaffDay = Math.floor(dayHours / 7);
        const nightIncome = Math.floor(addStaffDay * 0.9 * basePoint);
        document.getElementById('n-disp-income').innerText = nightIncome.toLocaleString();

        const profit = nightIncome - totalLabor;
        document.getElementById('n-disp-profit').innerText = profit.toLocaleString();
        const card = document.getElementById('n-profit-card');
        const msg = document.getElementById('n-analysis-msg');
        
        if(profit >= 0) {
            card.className = "card pass"; 
            msg.innerHTML = `<span style="color:var(--success)">âœ… ìˆ˜ì§€ ì–‘í˜¸: +${profit.toLocaleString()}ì›</span>`;
        } else {
            card.className = "card fail";
            msg.innerHTML = `<span style="color:var(--danger)">âš ï¸ ì†ì‹¤ ë°œìƒ: ${profit.toLocaleString()}ì›</span>`;
        }
    }

    window.onload = () => {
        initMain();
    };
</script>
</body>
</html>